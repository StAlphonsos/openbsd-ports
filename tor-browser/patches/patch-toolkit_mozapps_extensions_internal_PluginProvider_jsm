$OpenBSD$

diff -Nup mozilla-esr31/toolkit/mozapps/extensions/internal/PluginProvider.jsm tor-browser/toolkit/mozapps/extensions/internal/PluginProvider.jsm
--- toolkit/mozapps/extensions/internal/PluginProvider.jsm.orig	Mon Jan  5 23:08:05 2015
+++ toolkit/mozapps/extensions/internal/PluginProvider.jsm	Tue Feb 17 14:37:56 2015
@@ -52,6 +52,7 @@ var PluginProvider = {
   plugins: null,
 
   startup: function PL_startup() {
+    Services.obs.addObserver(this, "plugins-policy-changed", false);
     Services.obs.addObserver(this, LIST_UPDATED_TOPIC, false);
     Services.obs.addObserver(this, AddonManager.OPTIONS_NOTIFICATION_DISPLAYED, false);
   },
@@ -64,6 +65,7 @@ var PluginProvider = {
     this.plugins = null;
     Services.obs.removeObserver(this, AddonManager.OPTIONS_NOTIFICATION_DISPLAYED);
     Services.obs.removeObserver(this, LIST_UPDATED_TOPIC);
+    Services.obs.removeObserver(this, "plugins-policy-changed");
   },
 
   observe: function(aSubject, aTopic, aData) {
@@ -88,6 +90,15 @@ var PluginProvider = {
     case LIST_UPDATED_TOPIC:
       if (this.plugins)
         this.updatePluginList();
+      break;
+    case "plugins-policy-changed":
+      var plugin_policy = aData
+      if (!this.plugins)
+        this.plugins =[];
+      this.updatePluginList();
+      Services.obs.notifyObservers(null,
+                                   "plugin-provider-after-changed-policy",
+                                   plugin_policy);
       break;
     }
   },
