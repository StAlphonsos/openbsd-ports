$OpenBSD$

diff -Nup mozilla-esr31/security/certverifier/NSSCertDBTrustDomain.h tor-browser/security/certverifier/NSSCertDBTrustDomain.h
--- security/certverifier/NSSCertDBTrustDomain.h.orig	Mon Jan  5 23:07:59 2015
+++ security/certverifier/NSSCertDBTrustDomain.h	Tue Feb 17 14:37:56 2015
@@ -57,7 +57,8 @@ class NSSCertDBTrustDomain : public mozilla::pkix::Tru
     LocalOnlyOCSPForEV = 4,
   };
   NSSCertDBTrustDomain(SECTrustType certDBTrustType, OCSPFetching ocspFetching,
-                       OCSPCache& ocspCache, void* pinArg);
+                       OCSPCache& ocspCache, void* pinArg,
+                       CERTChainVerifyCallback* checkChainCallback = nullptr);
 
   virtual SECStatus FindPotentialIssuers(
                         const SECItem* encodedIssuerName,
@@ -78,6 +79,8 @@ class NSSCertDBTrustDomain : public mozilla::pkix::Tru
                                     PRTime time,
                        /*optional*/ const SECItem* stapledOCSPResponse);
 
+  virtual SECStatus IsChainValid(const CERTCertList* certChain);
+
 private:
   enum EncodedResponseSource {
     ResponseIsFromNetwork = 1,
@@ -93,6 +96,7 @@ class NSSCertDBTrustDomain : public mozilla::pkix::Tru
   const OCSPFetching mOCSPFetching;
   OCSPCache& mOCSPCache; // non-owning!
   void* mPinArg; // non-owning!
+  CERTChainVerifyCallback* mCheckChainCallback; // non-owning!
 };
 
 } } // namespace mozilla::psm
